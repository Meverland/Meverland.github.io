## 1.贝叶斯要解决的问题

- 正向概率：假设袋子里有N个白球，M个黑球，抽一个球，黑球的概率

  已知信息 求 未知信息

- 逆向概率：事先不知道袋子里黑白比例，随机抽球（一个或者好几个），观察取出来的球的颜色，推测袋子里面黑白的比例

  未知信息 求 已知信息

- 

​                                                                         **解决逆向概率**



## 2.贝叶斯公式推导

![img](https://s2.loli.net/2022/05/21/GvbVNioKar5H8Am.png)条件概率



![img](https://s2.loli.net/2022/05/21/9jeOBZEXSIn2yw8.png)

贝叶斯公式

在P(A|B)不好求的情况下，求P(B|A)



- **先验概率**：把P（A）称为**“先验概率**”：在不知道B事件的前提下，对A概率的一个主观判断
  - 一开始就有了自己的判断（先验概率-主观判断）

- **可能性函数**：P（B|A）/P（B）称为”**可能性函数**“，这是一个**调整因子**，新信息B带来的调整，作用是将先验概率调整到更接近真实概率
  - 即有了新信息之后，对先验概率的一个调整（优化）（可能性函数-调整因子），整理之后（后验概率）
  - 可能性函数 >1 :意味着“先验概率”被增强，A的可能性被调整大
  - 可能性函数=1：意味着B事件无助于判断事件A的可能性
  - 可能性函数<1:意味着”先验概率“被削弱，A的可能性变小了
- **后验概率**：P（A|B）在得到新信息之后经过优化得到的P（A）的 概率

- **底层思想**：在信息不足的情况下，尽可能做出一个好的预测，就是，在主观判断的基础上，先估计一个值，然后根据观察的新信息不断修正,**贝叶斯关注一个先验的条件，而不仅仅是数据**

- **总结**：贝叶斯定理可理解为

***后验概率（新信息出现后的A概率）=    先验概率（A概率）X 可能性函数（新信息带来的调整）***



## 3.拼写纠正实例

 

- 问题：用户输入一个不在字典中的单词**tha**，猜测真正想输的单词**the、than**.....
- P（我们猜测用户想输入的单词|他实际输入的单词）  ：一种猜想的概率

- 用户实际输入D（data，观测数据）

  - 有：猜测1：P（h1|D），猜 测2：P（h2|D）......

  - 对于不同猜想 h1、h2、h3 ，P(D)是一样的

  - P(h|D)=P(h)* P(D|h)/p(D)      即贝叶斯公式  
  - 比较猜想概率时P(D)可以省略    故  P(h|D)  正比于 P(D|h) * P(h)
  - **贝叶斯这一支机器学习：不只是考虑数据的影响，还有先验** P(h)
    - 不同的任务，算先验概率的方法不一样
  - P(D|h): **P(tha|the)**  把**the**写成**tha**的可能性有多大
  - 对于给定观测数据，一个猜测是好是坏，取决于”**这个猜测本身独立的可能性大小**“和”**这个猜测生成我们观测到数据的可能性大小**“

 





##  4.垃圾邮件过滤

- 问题：给定一封邮件，判定是否为垃圾邮件

  D来表示这封邮件，D是由N个单词组成的

  h+为垃圾邮件，h-为正常邮件

  

- ``` latex
  P(h+|D)=P(h+)*P(D|h+)/P(D)  异常
  P(h-|D)=P(h-)*P(D|h-)/P(D)  正常
  ```

  

- 先验概率：易得，P(h+)和P(h- ) 只需要计算一个邮件库里面异常邮件和正常邮件的比即可



- D中有N个词d1，d2，d3...，P(D|h+)=(d1,d2...dn|h+)

  **P(d1,d2...dn|h+) 就是在垃圾邮件中出现我们目前这封邮件一模一样的邮件的概率**

  P(d1,d2...dn|h+) **扩展为**：

  ```latex
  P(d1|h+)* P(d2|d1,h+)* p(d3|d2,d1,h+)*....  // 表示为顺序一样
  ```

  **假设**di和di-1 是完全条件无关的（**朴素贝叶斯**假设特征之间是独立，互不影响）（”朴素”的内涵可以理解为特征和特征之间独立性强）

  **化简为**:

  ````latex
  P(d1|h+)* P(d2|h+)* p(d3|h+)*.... //只要统计di这个单词在垃圾邮件里出现的频率即可
  ````


​       朴素贝叶斯就是化简使用的：每一个步骤之间是没有关系的

​       P(d1|h+)  : 在异常邮件中 出现d1这个词的词频

- 再算

  ```latex
  P(d1|h-)* P(d2|h-)* p(d3|h-)*.... //正常邮件中词频的累积乘
  ```

- 再回到贝叶斯公式：



**后验概率（新信息出现后的A概率）=    先验概率（A概率）X 可能性函数（新信息带来的调整）**



## 5.朴素贝叶斯算法整体框架

1. 求先验概率：简单，统计
2.  P(d1|h+)  : 在异常/正常邮件中 出现d1这个词的词频
3. 乘积，并代入贝叶斯公式，求后验概率



- 构建一个预料表 假设为1000个 

  其中800 异常词库  800正常词库，测试数据100个词



- 要在代码中解决的问题.1：P(d1|h+) =0：在异常邮件中 出现d1这个词的词频为0

  但是朴素贝叶斯中是累乘

- 要在代码中解决的问题.2：每一个P(d1|h+)都是一个很小的值，100个相乘约等于0了

## 6.代码实现  //此处还未学完 ，python 的代码还不熟悉，等我补完python 就试着把这个学完（做完）

#### 1.邮件数据读取

#### 2.预料表与特征向量的构建

#### 3.分类别统计词频

#### 4.贝叶斯公式对数变换

#### 5.完成预测模块
